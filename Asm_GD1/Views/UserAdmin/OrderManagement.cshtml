@{
    ViewData["Title"] = "Quản lý đơn hàng";
    Layout = "_AdminLayout";
}

@section Styles {
    <link rel="stylesheet" href="~/css/pages/admin-orders.css" />
}

<div class="admin-orders">
    <div class="page-header">
        <h1>Quản lý đơn hàng</h1>
        <div class="header-actions">
            <button class="btn-export" onclick="exportOrders()">
                <i class="fas fa-download"></i>
                Xuất Excel
            </button>
            <button class="btn-refresh" onclick="refreshOrders()">
                <i class="fas fa-sync-alt"></i>
                Làm mới
            </button>
        </div>
    </div>

    <!-- Statistics Cards -->
    <div class="stats-cards">
        <div class="stat-card pending">
            <div class="stat-icon">
                <i class="fas fa-clock"></i>
            </div>
            <div class="stat-content">
                <h3>24</h3>
                <p>Chờ xác nhận</p>
                <span class="stat-change">+3 từ hôm qua</span>
            </div>
        </div>

        <div class="stat-card confirmed">
            <div class="stat-icon">
                <i class="fas fa-check-circle"></i>
            </div>
            <div class="stat-content">
                <h3>89</h3>
                <p>Đã xác nhận</p>
                <span class="stat-change">+12 từ hôm qua</span>
            </div>
        </div>

        <div class="stat-card delivering">
            <div class="stat-icon">
                <i class="fas fa-truck"></i>
            </div>
            <div class="stat-content">
                <h3>45</h3>
                <p>Đang giao</p>
                <span class="stat-change">+8 từ hôm qua</span>
            </div>
        </div>

        <div class="stat-card completed">
            <div class="stat-icon">
                <i class="fas fa-check-double"></i>
            </div>
            <div class="stat-content">
                <h3>234</h3>
                <p>Hoàn thành</p>
                <span class="stat-change">+45 từ hôm qua</span>
            </div>
        </div>
    </div>

    <!-- Filters -->
    <div class="filters-section">
        <div class="filter-group">
            <label>Trạng thái:</label>
            <select id="statusFilter" onchange="filterOrders()">
                <option value="">Tất cả</option>
                <option value="pending">Chờ xác nhận</option>
                <option value="confirmed">Đã xác nhận</option>
                <option value="preparing">Đang chuẩn bị</option>
                <option value="delivering">Đang giao</option>
                <option value="completed">Hoàn thành</option>
                <option value="cancelled">Đã hủy</option>
            </select>
        </div>

        <div class="filter-group">
            <label>Ngày:</label>
            <input type="date" id="dateFilter" onchange="filterOrders()">
        </div>

        <div class="filter-group">
            <label>Tìm kiếm:</label>
            <input type="text" id="searchFilter" placeholder="Mã đơn, tên khách hàng..." onkeyup="filterOrders()">
        </div>

        <div class="filter-group">
            <button class="btn-clear-filters" onclick="clearFilters()">
                <i class="fas fa-times"></i>
                Xóa bộ lọc
            </button>
        </div>
    </div>

    <!-- Orders Table -->
    <div class="orders-table-container">
        <table class="orders-table">
            <thead>
                <tr>
                    <th>Mã đơn</th>
                    <th>Khách hàng</th>
                    <th>Món ăn</th>
                    <th>Tổng tiền</th>
                    <th>Trạng thái</th>
                    <th>Thời gian</th>
                    <th>Hành động</th>
                </tr>
            </thead>
            <tbody id="ordersTableBody">
                <tr data-status="pending" data-date="2024-12-16">
                    <td>
                        <span class="order-id">#DH001</span>
                    </td>
                    <td>
                        <div class="customer-info">
                            <strong>Nguyễn Văn A</strong>
                            <span>0123456789</span>
                        </div>
                    </td>
                    <td>
                        <div class="order-items">
                            <span>Cơm tấm sườn nướng x2</span>
                            <span class="item-count">+1 món khác</span>
                        </div>
                    </td>
                    <td>
                        <span class="order-total">196,000₫</span>
                    </td>
                    <td>
                        <span class="status-badge pending">Chờ xác nhận</span>
                    </td>
                    <td>
                        <div class="time-info">
                            <span>16/12/2024</span>
                            <span>14:30</span>
                        </div>
                    </td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn-action view" onclick="viewOrder(1)" title="Xem chi tiết">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn-action edit" onclick="editOrder(1)" title="Chỉnh sửa">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn-action confirm" onclick="confirmOrder(1)" title="Xác nhận">
                                <i class="fas fa-check"></i>
                            </button>
                            <button class="btn-action cancel" onclick="cancelOrder(1)" title="Hủy">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </td>
                </tr>

                <tr data-status="confirmed" data-date="2024-12-16">
                    <td>
                        <span class="order-id">#DH002</span>
                    </td>
                    <td>
                        <div class="customer-info">
                            <strong>Trần Thị B</strong>
                            <span>0987654321</span>
                        </div>
                    </td>
                    <td>
                        <div class="order-items">
                            <span>Phở bò tái</span>
                        </div>
                    </td>
                    <td>
                        <span class="order-total">65,000₫</span>
                    </td>
                    <td>
                        <span class="status-badge confirmed">Đã xác nhận</span>
                    </td>
                    <td>
                        <div class="time-info">
                            <span>16/12/2024</span>
                            <span>15:15</span>
                        </div>
                    </td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn-action view" onclick="viewOrder(2)">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn-action prepare" onclick="prepareOrder(2)" title="Chuẩn bị">
                                <i class="fas fa-utensils"></i>
                            </button>
                            <button class="btn-action cancel" onclick="cancelOrder(2)">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </td>
                </tr>

                <tr data-status="delivering" data-date="2024-12-16">
                    <td>
                        <span class="order-id">#DH003</span>
                    </td>
                    <td>
                        <div class="customer-info">
                            <strong>Lê Văn C</strong>
                            <span>0369258147</span>
                        </div>
                    </td>
                    <td>
                        <div class="order-items">
                            <span>Bánh mì thịt nướng x3</span>
                        </div>
                    </td>
                    <td>
                        <span class="order-total">90,000₫</span>
                    </td>
                    <td>
                        <span class="status-badge delivering">Đang giao</span>
                    </td>
                    <td>
                        <div class="time-info">
                            <span>16/12/2024</span>
                            <span>16:00</span>
                        </div>
                    </td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn-action view" onclick="viewOrder(3)">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="btn-action track" onclick="trackOrder(3)" title="Theo dõi">
                                <i class="fas fa-map-marker-alt"></i>
                            </button>
                            <button class="btn-action complete" onclick="completeOrder(3)" title="Hoàn thành">
                                <i class="fas fa-check-double"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <!-- Pagination -->
    <div class="pagination">
        <button class="page-btn prev" onclick="changePage(-1)">
            <i class="fas fa-chevron-left"></i>
            Trước
        </button>
        <span class="page-info">Trang 1 / 5</span>
        <button class="page-btn next" onclick="changePage(1)">
            Sau
            <i class="fas fa-chevron-right"></i>
        </button>
    </div>
</div>

<!-- Order Detail Modal -->
<div class="modal" id="orderDetailModal">
    <div class="modal-content large">
        <div class="modal-header">
            <h3>Chi tiết đơn hàng #DH001</h3>
            <button class="modal-close" onclick="closeModal('orderDetailModal')">&times;</button>
        </div>

        <div class="modal-body">
            <div class="order-detail-grid">
                <div class="order-info">
                    <h4>Thông tin đơn hàng</h4>
                    <div class="info-item">
                        <label>Mã đơn:</label>
                        <span>#DH001</span>
                    </div>
                    <div class="info-item">
                        <label>Trạng thái:</label>
                        <span class="status-badge pending">Chờ xác nhận</span>
                    </div>
                    <div class="info-item">
                        <label>Thời gian đặt:</label>
                        <span>16/12/2024 14:30</span>
                    </div>
                    <div class="info-item">
                        <label>Phương thức thanh toán:</label>
                        <span>Thanh toán khi nhận hàng</span>
                    </div>
                </div>

                <div class="customer-detail">
                    <h4>Thông tin khách hàng</h4>
                    <div class="info-item">
                        <label>Tên:</label>
                        <span>Nguyễn Văn A</span>
                    </div>
                    <div class="info-item">
                        <label>Điện thoại:</label>
                        <span>0123456789</span>
                    </div>
                    <div class="info-item">
                        <label>Địa chỉ:</label>
                        <span>123 Đường ABC, Quận 1, TP.HCM</span>
                    </div>
                    <div class="info-item">
                        <label>Ghi chú:</label>
                        <span>Giao hàng trước 6h chiều</span>
                    </div>
                </div>
            </div>

            <div class="order-items-detail">
                <h4>Chi tiết món ăn</h4>
                <table class="items-table">
                    <thead>
                        <tr>
                            <th>Món ăn</th>
                            <th>Số lượng</th>
                            <th>Đơn giá</th>
                            <th>Thành tiền</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Cơm tấm sườn nướng</td>
                            <td>2</td>
                            <td>45,000₫</td>
                            <td>90,000₫</td>
                        </tr>
                        <tr>
                            <td>Phở bò tái</td>
                            <td>1</td>
                            <td>65,000₫</td>
                            <td>65,000₫</td>
                        </tr>
                    </tbody>
                    <tfoot>
                        <tr>
                            <td colspan="3"><strong>Tạm tính:</strong></td>
                            <td><strong>155,000₫</strong></td>
                        </tr>
                        <tr>
                            <td colspan="3"><strong>Phí giao hàng:</strong></td>
                            <td><strong>15,000₫</strong></td>
                        </tr>
                        <tr>
                            <td colspan="3"><strong>Giảm giá:</strong></td>
                            <td><strong>-15,500₫</strong></td>
                        </tr>
                        <tr class="total-row">
                            <td colspan="3"><strong>Tổng cộng:</strong></td>
                            <td><strong>154,500₫</strong></td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>

        <div class="modal-footer">
            <button class="btn-secondary" onclick="closeModal('orderDetailModal')">Đóng</button>
            <button class="btn-primary" onclick="printOrder()">In đơn hàng</button>
        </div>
    </div>
</div>
